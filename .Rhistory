################################ Figure 5 ######################################
# Load simulation data
files_pattern <- "networkInteraction_r6_types100_timeLimitFALSE1_.*\\.RData"
results <- combine_results(data_dir, files_pattern)
load("/Users/gakcakir/Documents/GitHub/Group-Problem-Solving/data/networkInteraction_r6_types100_timeLimitFALSE1_6568083.RData")
source("scripts/combine_results.R") # function to combine results from multiple batches
results <- combine_results(data_dir, files_pattern)
# Create summary table
results_summary <- results %>% group_by(network, p_level, rep_no) %>%
summarise(avg_payoff = mean(z),
max_payoff = max(z),
found_peak = (max(z)==100)) %>%
group_by(network, p_level) %>%
summarise(avg_avg_payoff = mean(avg_payoff),
se_avg_payoff = sd(avg_payoff) / sqrt(n()),
avg_max_payoff = mean(max_payoff),
se_max_payoff = sd(max_payoff) / sqrt(n()),
max_max_payoff = max(max_payoff),
percent_found_peak = mean(found_peak))
# Figure 5: Communication profile x Network structure - Avg and Max Performances
fig5_avg <- results_summary %>%
ggplot(aes(x = p_level, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
guides(color = guide_legend(title = "Network"))+
labs(
x = "Probability of Collaborating",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
fig5_max <- results_summary %>%
ggplot(aes(x = p_level, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Probability of Collaborating",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
fig5 <- fig5_max + fig5_avg
fig5
View(results_t)
View(results)
ggsave("figures/networkInteraction.pdf", plot = fig5, width = 9, height = 3, family = "Times", pointsize = 12)
################################ Figure 7 ######################################
# Load simulation data
files_pattern <- "collaborateFirst_r6_types100_timeLimitTRUE10_.*\\.RData"
results <- combine_results(data_dir, files_pattern)
# Create summary table
results_summary <- results %>% group_by(network, timeFirstCopy, rep_no) %>%
summarise(avg_payoff = mean(z),
max_payoff = max(z),
found_peak = (max(z)==100)) %>%
group_by(network, timeFirstCopy) %>%
summarise(avg_avg_payoff = mean(avg_payoff),
se_avg_payoff = sd(avg_payoff) / sqrt(n()),
avg_max_payoff = mean(max_payoff),
se_max_payoff = sd(max_payoff) / sqrt(n()),
max_max_payoff = max(max_payoff),
percent_found_peak = mean(found_peak))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(#title = paste("r =",results[1,]$r,"   types =",results[1,]$n_of_types),
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
#ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
#ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
# ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")#+
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstMax
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
# ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
#theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
# ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
collabFirstMax
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
collabFirstMax
source("~/Documents/GitHub/Group-Problem-Solving/scripts/figures.R", echo=TRUE)
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
collabFirstMax
# Create summary table
results_summary <- results %>% group_by(network, timeFirstCopy, rep_no) %>%
summarise(avg_payoff = mean(z),
max_payoff = max(z),
found_peak = (max(z)==100)) %>%
group_by(network, timeFirstCopy) %>%
summarise(avg_avg_payoff = mean(avg_payoff),
se_avg_payoff = sd(avg_payoff) / sqrt(n()),
avg_max_payoff = mean(max_payoff),
se_max_payoff = sd(max_payoff) / sqrt(n()),
max_max_payoff = max(max_payoff),
percent_found_peak = mean(found_peak))
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
collabFirstMax
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()#+
collabFirstMax
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstMax
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
#scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
fig7 <- collabFirstMax + collabFirstAve
fig7
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, t, by = 2),limits=c(0,t))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
fig7 <- collabFirstMax + collabFirstAve
fig7
View(results_summary)
load("/Users/gakcakir/Library/CloudStorage/Box-Box/gulsah/Teams (lamberson@ucla.edu)/Simple Model/data/density_r6_types100_timeLimitFALSE1/density_r6_types100_timeLimitFALSE1_6576782.RData")
View(results_t)
load("/Users/gakcakir/Library/CloudStorage/Box-Box/gulsah/Teams (lamberson@ucla.edu)/Simple Model/data/density_r6_types100_timeLimitFALSE1/density_r6_types100_timeLimitFALSE1_6565564.RData")
View(results_t)
load("/Users/gakcakir/Library/CloudStorage/Box-Box/gulsah/Teams (lamberson@ucla.edu)/Simple Model/data/collaborateFirst_r6_types100_timeLimitTRUE10/collaborateFirst_r6_types100_timeLimitTRUE10_7470461.RData")
################################ Figure 7 ######################################
# Load simulation data
files_pattern <- "collaborateFirst_r6_types100_timeLimitTRUE10_.*\\.RData"
results <- combine_results(data_dir, files_pattern)
View(results)
View(results)
# Create summary table
results_summary <- results %>% group_by(network, timeFirstCopy, rep_no) %>%
summarise(avg_payoff = mean(z),
max_payoff = max(z),
found_peak = (max(z)==100)) %>%
group_by(network, timeFirstCopy) %>%
summarise(avg_avg_payoff = mean(avg_payoff),
se_avg_payoff = sd(avg_payoff) / sqrt(n()),
avg_max_payoff = mean(max_payoff),
se_max_payoff = sd(max_payoff) / sqrt(n()),
max_max_payoff = max(max_payoff),
percent_found_peak = mean(found_peak))
View(results_summary)
View(results)
View(results_t)
View(results_t)
View(results_summary)
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, x, by = 2),limits=c(0,x))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, timeFirstCopy, by = 2),limits=c(0,timeFirstCopy))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstAve <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_avg_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_avg_payoff,
ymin = avg_avg_payoff - se_avg_payoff,
ymax = avg_avg_payoff + se_avg_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, 10, by = 2),limits=c(0,10))+
guides(color = guide_legend(title = "Network"))+
#theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Average payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
collabFirstAve
# Figure 7: # of rounds of collaboration x Network structure - Avg and Max Performances
collabFirstMax <- results_summary %>%
ggplot(aes(x = timeFirstCopy, y = avg_max_payoff, colour = network, group = network)) +
geom_line() +
geom_point() +
ylim(44,75)+
geom_errorbar(aes(y = avg_max_payoff,
ymin = avg_max_payoff - se_max_payoff,
ymax = avg_max_payoff + se_max_payoff),
width=0)+
scale_color_manual(values = c( "#440154", "#5ec962"), labels = c("Fully connected", "Linear")) +
scale_x_continuous(breaks = seq(0, 10, by = 2),limits=c(0,10))+
guides(color = "none")+
theme(legend.position = "none")+
labs(
x = "Rounds of collaboration (k)",
y= "Best member payoff")+
theme_classic()+
theme(axis.text.y = element_text(margin = margin(r = 8)))
fig7 <- collabFirstMax + collabFirstAve
fig7
